#### Volatility cones（波动率锥）是一种用于可视化未来波动率可能的范围的图形工具。它通常用于金融市场中，特别是用于股票和期权市场。波动率锥是由历史价格和期权价格数据计算而来，可以用于估计未来某一资产价格的波动率的范围。波动率锥显示了波动率在不同时间间隔内的预期范围，通常用百分比表示。波动率锥通常是向上开口的，表示较短时间间隔内的波动率较高，而随着时间的推移，波动率会趋于平稳。波动率锥可以帮助投资者了解市场预期的波动率，并帮助他们在制定投资策略时考虑到这一因素。


#### Volatility rolling percentiles 是一种用于衡量资产波动性的统计指标，它基于某一时间段内的历史波动性数据，通过滚动计算波动性的百分位数，来获取资产当前波动性相对于历史波动性的位置。具体来说，首先需要选取一定时间段（例如过去一年）内的资产波动性数据，然后将这些数据按照时间顺序排序，接着每次移动一个固定大小的窗口（例如一个月），在每个窗口内计算波动性的百分位数（例如95%），这个百分位数就是该时间段内的波动性 rolling percentile。Volatility rolling percentiles 可以帮助分析者更好地了解资产当前的波动性水平相对于历史水平的位置，从而作出更准确的投资决策。例如，如果当前波动性 rolling percentile 非常高（例如95%以上），说明资产当前的波动性处于历史上的高位，可能需要更加谨慎地进行投资。反之，如果当前波动性 rolling percentile 较低（例如5%以下），则说明资产当前的波动性处于历史上的低位，可能存在投资机会。




#### DataFrame rolling 

```
mean(): 计算每个滑动窗口内的均值。
sum(): 计算每个滑动窗口内的总和。
min(): 计算每个滑动窗口内的最小值。
max(): 计算每个滑动窗口内的最大值。
count(): 计算每个滑动窗口内的非缺失值数量。
std(): 计算每个滑动窗口内的标准差。
var(): 计算每个滑动窗口内的方差。
median(): 计算每个滑动窗口内的中位数。
quantile(): 计算每个滑动窗口内的分位数。
cov(): 计算每个滑动窗口内的协方差。
corr(): 计算每个滑动窗口内的相关系数。
kurt(): 计算每个滑动窗口内的峰度。
skew(): 计算每个滑动窗口内的偏度。
sem() 方法用于计算每个滑动窗口内的标准误差。
rank() 方法用于计算每个滑动窗口内元素的排名。
```

```
峰度：峰度描述分布的尖锐程度，通常与正态分布进行比较。在金融中，高峰度的分布可能意味着价格或收益率的波动性比正态分布更高，也就是说，价格或收益率变动更加集中在平均值附近，而极端值更为罕见。

偏度：偏度描述分布的偏斜程度，即分布是否对称。在金融中，负偏度可能表明价格或收益率的下行风险大于上行风险，即有更多的极端下行值。正偏度则表示相反的情况，即上行风险更大。
左偏分布是指分布的尾部向左侧延伸.


```

#### Garman-Klass, Hodges-Tompkins, Kurtosis, Parkinson, Raw, Rogers-Satchell, Skew, Yang-Zhang
```

对于高频数据，可以优先选择Garman-Klass、Hodges-Tompkins、Raw和Skew等简单易用的估值方法，以及Kurtosis和Yang-Zhang等具有更高准确性的方法。

#+1
对于长期变化较大的股票，可以优先选择Parkinson、Rogers-Satchell和Yang-Zhang等具有更高准确性的方法，以避免偏差较大的情况。
对于存在价格跳跃的市场，应该尽量避免使用需要每日最高价和最低价的估值方法，例如Parkinson和Rogers-Satchell，而应该优先选择其他方法。相比之下，Garman-Klass和Hodges-Tompkins方法使用的是收盘价和开盘价，不需要考虑最高价和最低价，因此更适合应用于这类市场。同时，Raw方法也可以考虑，因为它基于收益率的平方，对价格跳跃的影响相对较小。


在进行波动率预测时，可以先使用简单易用的估值方法，例如Garman-Klass、Raw和Skew等，以快速了解波动率的变化趋势和波动范围。然后再根据具体情况选择其他更准确的方法进行验证和修正。


对于特定类型的数据，例如存在噪声或缺失的数据，可以使用具有更高准确性的估值方法，例如Yang-Zhang等。
对于市场价格的日内波动率估计，建议使用Garman-Klass, Parkinson或Raw方法。这些方法都考虑了当日价格的最高价和最低价。
对于市场价格的长期波动率估计，建议使用Hodges-Tompkins或Yang-Zhang方法。这些方法可以更好地捕捉长期趋势和波动性的变化。
如果您对数据分布的偏斜程度感兴趣，可以使用Skew方法来计算偏斜度。如果您还想了解数据尾部的厚度和峰度，可以使用Kurtosis方法。

如果您想要同时考虑偏斜度和尾部厚度，可以使用Rogers-Satchell方法，因为它结合了Skew和Kurtosis的优点。
对于需要考虑交易成本的情况，可以使用Garman-Klass方法。因为该方法考虑了价格波动以及交易成本对波动率的影响。



```

```
除了上述提到的搭配方法外，这些波动率估值方法还可以与其他指标和技术分析方法一起使用来获得更全面的市场分析。以下是一些常见的搭配方法：
与移动平均线搭配使用：将波动率估值与移动平均线结合使用可以帮助识别市场的趋势和波动性。例如，将Hodges-Tompkins方法与长期移动平均线结合使用可以更好地捕捉长期趋势的变化。例如，当使用Hodges-Tompkins方法来估计股票的波动率时，我们可以将其与长期移动平均线结合使用。如果股票的价格趋势与移动平均线相比变化较小，我们可以推断出股票价格波动较小，而波动率较低。相反，如果股票的价格趋势与移动平均线相比变化较大，我们可以推断出股票价格波动较大，而波动率较高。通过这种方式，我们可以更好地了解价格趋势和波动性的关系，从而更好地预测市场的未来走势。

与布林带搭配使用：将波动率估值与布林带结合使用可以帮助判断价格的高低点和趋势。例如，将Raw方法的波动率估值用于布林带的计算可以帮助识别价格的波动性和范围。布林带是一个可以帮助判断价格高低点和趋势的技术指标，通过计算移动平均线和标准差来构建上下两条带状线，并根据价格是否在带状线之间来判断价格的波动性和范围。而将波动率估值与布林带结合使用，可以使得布林带更加准确地反映价格的波动性，从而更好地判断价格的趋势和波动性。例如，使用Raw方法的波动率估值可以帮助调整布林带的上下限，使其更好地适应市场的波动性。

与隐含波动率搭配使用：将历史波动率估值与隐含波动率结合使用可以帮助判断市场预期和未来的价格波动性。例如，将Yang-Zhang方法的波动率估值与期权价格的隐含波动率进行比较可以帮助判断市场对未来价格波动性的预期。#+1 如果历史波动率较低，但隐含波动率较高，可能意味着市场对未来的价格波动性有更高的预期，这可以促使投资者采取相应的风险管理措施。

与其他技术分析方法搭配使用：例如，将Kurtosis方法的波动率估值用于判断市场价格的峰度可以与MACD等其他技术指标结合使用，从而更全面地分析市场的趋势和波动性。例如，如果Kurtosis方法的波动率估值较高，表明价格波动性较大，而MACD的快线上穿慢线，表明价格趋势向上，这可能表明市场处于上涨行情中。另一方面，如果Kurtosis方法的波动率估值较低，表明价格波动性较小，而MACD的快线下穿慢线，表明价格趋势向下，这可能表明市场处于下跌行情中。

需要注意的是，不同的波动率估值方法和技术分析方法之间的搭配可能因市场和个人偏好的不同而异，因此需要根据具体情况进行选择和实践。
```

```
# +1
这几个波动率估值指标中，Garman-Klass、Hodges-Tompkins、Parkinson、Yang-Zhang等指标与期权的希腊值一起使用效果较好。这些波动率估值指标可以帮助投资者更准确地估计资产价格波动率，从而更好地预测期权的价格变动，并进一步计算期权的希腊值。
例如，Garman-Klass方法主要考虑了价格波动性与收盘价、最高价和最低价的关系，可以较为准确地估计价格波动性。当使用Garman-Klass波动率与期权的希腊值一起使用时，投资者可以更好地估计期权的价格变动以及其隐含波动率的变化。
Hodges-Tompkins方法则考虑了价格序列中的跳跃性，并且对价格的极值进行了平滑处理，因此在较为剧烈的价格波动下能够较为准确地估计价格波动率。Parkinson方法使用了最高价和最低价，同时忽略了开盘价和收盘价之间的噪声，因此对于趋势性价格波动具有一定的优势。Yang-Zhang方法则将价格波动性的长期趋势和短期波动结合起来，可以更好地反映价格的实际波动情况。
总的来说，结合Garman-Klass、Hodges-Tompkins、Parkinson、Yang-Zhang等波动率估值指标与期权的希腊值一起使用可以提高投资者对价格波动性的预测能力，从而更好地制定风险管理策略和投资决策。 
Garman-Klass、Hodges-Tompkins、Parkinson、Yang-Zhang等波动率估值指标的选择取决于所研究的资产价格的特征，不同的波动率估值指标适用于不同的市场情况和资产种类。因此，在选择波动率估值指标时需要根据实际情况进行合理选择。
其次，使用波动率估值指标与期权的希腊值一起使用时，需要注意对期权的不同类型和不同到期时间进行分析，并进行合理的模型选择和参数估计。同时，还需要考虑到隐含波动率、历史波动率和预期波动率等因素的综合影响，以提高对价格波动性的预测准确性。
最后，需要强调的是，波动率估值指标只是对价格波动性的一种近似估计，不能完全代表价格的波动情况。因此，在制定风险管理策略和投资决策时，还需要考虑到其他因素的影响，如市场流动性、政策变化、宏观经济环境等。
```




####

``
对于每个估算器，可以绘制以下图形：
概率锥
滚动分位数
滚动极值
滚动描述统计
直方图
与任意可比较数据进行比较的对比
与任意可比较数据进行相关性分析
与任意可比较数据进行回归分析

帮助投资者更好地了解市场的特征和价格的波动性，以便做出更明智的投资决策。它们可以帮助投资者识别价格的趋势和周期性变化，评估市场的风险水平和未来价格的概率范围，以及与其他数据进行比较、相关性分析和回归分析。

概率锥：用于显示未来价格的概率范围。通常，概率锥是基于历史波动率计算的，并考虑到市场的流动性和未来事件的可能性。概率锥可用于帮助投资者决定是否需要对其投资组合进行调整。
滚动分位数：显示数据的中位数、上下四分位数等分位数信息，这些信息可以用来描述数据的分布特征。滚动分位数是基于一定时间窗口内的数据进行计算的，可以帮助投资者识别价格走势的趋势和周期性变化。
滚动极值：显示数据在一定时间窗口内的最大值和最小值，可以用来判断市场的波动性和价格的极端走势。滚动极值也可以用来识别价格的趋势和周期性变化。
滚动描述统计：包括均值、标准差、偏度、峰度等统计量，用于描述数据的中心趋势、离散程度和分布形态等特征。滚动描述统计通常基于一定时间窗口内的数据进行计算，可以帮助投资者了解价格走势的变化和市场的风险水平。
直方图：用于显示数据的分布情况，通常将数据按照一定区间划分为若干组，然后统计每组的频数或频率。直方图可以帮助投资者了解数据的分布形态和偏态性，以及数据在不同区间的分布情况。
与任意可比较数据进行比较的对比：用于比较同一市场、同一品种或不同市场、不同品种的数据，以便找出它们之间的相似性和差异性。这种对比可以帮助投资者更好地理解市场的特征和价格的波动性。
与任意可比较数据进行相关性分析：用于分析两个或多个变量之间的相关性，以便找出它们之间的关系和趋势。相关性分析可以帮助投资者识别出市场中存在的因果关系和价格之间的相互作用。
与任意可比较数据进行回归分析：用于建立两个或多个变量之间的数学模型，以便预测一个变量的取值。回归分析可以帮助投资者预测市场的未来走势和价格变化，并制定相应的投资策略。



```
Garman-Klass (GK)：适用于高频数据，例如秒级别的数据，但需要有成交量数据作为输入。

Hodges-Tompkins (HT)：适用于高频数据，例如秒级别的数据，不需要成交量数据，但需要数据是等间隔的。

Kurtosis：适用于长期投资组合的波动率估计，可以有效地衡量长尾风险。

Parkinson：适用于低频数据，例如日级别的数据，可以有效地去除市场开盘和收盘时的噪声。

Raw：适用于低频数据，例如日级别的数据，是 Parkinson 波动率的一种变体，对极端值更加敏感。

Rogers-Satchell (RS)：适用于高频数据，例如秒级别的数据，可以有效地处理收益率具有异方差性的情况。

Skew：适用于长期投资组合的波动率估计，可以有效地衡量偏态风险。

Yang-Zhang (YZ)：适用于高频数据，例如秒级别的数据，具有较好的抗噪声性能，并且可以有效地处理收益率具有异方差性的情况。 

Garman-Klass (GK) 波动率适用于高频数据，例如秒级别的数据，并且需要成交量数据作为输入。它使用了高、低、开、收价格以及成交量等信息来计算波动率。
Hodges-Tompkins (HT) 波动率适用于高频数据，例如秒级别的数据，并且要求数据是等间隔的。HT 波动率可以通过差分计算价格的一阶和二阶导数，进而估计波动率。
Kurtosis 波动率适用于长期投资组合的波动率估计，可以有效地衡量长尾风险，即异常大的价格波动的风险。与传统的波动率估计方法相比，Kurtosis 波动率更为敏感，因此可以更准确地捕捉价格分布的尾部。
Parkinson 波动率适用于低频数据，例如日级别的数据，并可以有效地去除市场开盘和收盘时的噪声。它使用了高、低价格信息来计算波动率，但忽略了成交量等其他因素。
Raw 波动率是 Parkinson 波动率的一种变体，适用于低频数据，例如日级别的数据。与 Parkinson 波动率不同的是，Raw 波动率对价格序列的极端值更加敏感。
Rogers-Satchell (RS) 波动率适用于高频数据，例如秒级别的数据，并且可以有效地处理收益率具有异方差性的情况。RS 波动率使用了价格序列的一阶和二阶差分，进而估计波动率。
Skew 波动率适用于长期投资组合的波动率估计，并可以有效地衡量偏态风险，即价格分布的非对称性。Skew 波动率基于偏度估计，可以更准确地反映价格分布的偏态情况。
Yang-Zhang (YZ) 波动率适用于高频数据，例如秒级别的数据，并且具有较好的抗噪声性能，同时可以有效地处理收益率具有异方差性的情况。YZ 波动率使用了价格序列的一阶和二阶差分，同时引入了自适应参数，可以更好地适应价格序列的变化。

这些波动率估计方法都有其适用范围和限制条件。在选择哪种波动率估计方法时，需要根据数据类型、采样频率、波动率计算目的以及可能存在的异方差性、噪声等因素进行综合考虑

这些波动率估计方法的计算公式和具体实现方式可能会因为不同的证券市场、数据供应商或计算软件而有所不同。因此，在使用这些波动率估计方法时，需要了解其具体的计算公式和参数设置，并在实际应用中进行验证和调整。
在使用波动率估计方法时，还需要考虑其滞后性、稳定性和精度等方面的问题。例如，某些波动率估计方法可能会对价格序列中的极端值或异常值过于敏感，从而导致波动率估计结果的不稳定性或偏差；而另一些波动率估计方法可能会忽略价格序列中的一些重要信息，从而导致波动率估计结果的精度不足。
在实际应用中，波动率估计方法往往需要与其他金融模型或投资策略相结合，例如用于计算期权隐含波动率、构建风险控制模型、或者评估投资组合的风险和收益等。因此，在使用波动率估计方法时，需要考虑其与其他模型或策略的兼容性和相互作用，以确保计算结果的准确性和可靠性。
Garman-Klass (GK)
Garman-Klass 波动率是一种针对金融时间序列的波动率估计方法，适用于高频数据，例如秒级别的数据。它是一种基于价格和成交量数据的加权移动平均方法，其中包括了四个不同的价格指标（开盘价、最高价、最低价、收盘价）以及成交量信息。GK 波动率可以用来衡量价格波动的大小，以及在风险控制和期权定价等领域中的应用。

Hodges-Tompkins (HT)
Hodges-Tompkins 波动率是一种适用于高频数据（如秒级别数据）的波动率估计方法，不需要成交量数据，但需要数据是等间隔的。它是一种基于时间序列差分的方法，将价格序列转换为其一阶差分序列，然后计算其方差的平方根。HT 波动率可以用来衡量价格波动的大小，特别是在处理金融市场的高频数据时，具有简单、有效的优点。

Kurtosis
Kurtosis 波动率是一种适用于长期投资组合的波动率估计方法，可以有效地衡量长尾风险。Kurtosis 波动率计算时先将价格序列转换为对数收益率序列，然后计算其四阶中心矩（即峰度），最后用峰度除以方差的平方根得到波动率估计值。由于峰度反映了收益率序列的尾部厚度和尾部频率，因此 Kurtosis 波动率在处理具有长尾特征的金融时间序列时具有一定的优势。

Parkinson
Parkinson 波动率是一种适用于低频数据（如日级别数据）的波动率估计方法，可以有效地去除市场开盘和收盘时的噪声。Parkinson 波动率计算时基于价格序列的最高价和最低价，忽略了其他价格信息。该方法可以通过减小价格序列的噪声来提高波动率的估计精度。

Raw
Raw 波动率是一种适用于低频数据（如日级别数据）的波动率估计方法，是 Parkinson 波动率的一种变体，对极端值更加敏感。Raw 波动率计算时也基于价格序列的最高价和最低价，但是对于每个交易日，它采用了价格序列中的全部价格信息。该方法可以更加敏感地捕捉价格序列的波动性，但同时也更加容易受到异常值的影响。

Rogers-Satchell (RS)
Rogers-Satchell 波动率是一种适用于高频数据（如秒级别数据）的波动率估计方法，可以有效地处理收益率具有异方差性的情况。该方法通过对收益率序列进行加权，将异方差性的影响降低到相同的水平，从而得到更为准确的波动率估计结果。具体来说，RS 波动率计算时需要先对收益率序列进行预处理，以确保其具有均值为零、方差为一的特性。然后，使用指数加权移动平均方法计算收益率序列的加权标准差，得到最终的波动率估计值。

Skew
Skew 波动率是一种适用于长期投资组合的波动率估计方法，可以有效地衡量偏态风险。Skew 波动率计算时同样先将价格序列转换为对数收益率序列，然后计算其三阶中心矩（即偏度），最后用偏度除以方差的平方根得到波动率估计值。由于偏度反映了收益率序列的偏斜程度，因此 Skew 波动率在处理具有偏态特征的金融时间序列时具有一定的优势。

Yang-Zhang (YZ)
Yang-Zhang 波动率是一种适用于高频数据（如秒级别数据）的波动率估计方法，具有较好的抗噪声性能，并且可以有效地处理收益率具有异方差性的情况。该方法基于收益率序列的滑动窗口，采用加权指数平滑方法进行波动率估计。在计算加权指数平滑系数时，YZ 波动率考虑了噪声因素对波动率估计的影响，以进一步提高估计精度。

以上是各种波动率估计方法的简要介绍，每种方法都有其适用的场景和特点。在实际应用中，需要根据数据的特性和具体的需求选择合适的波动率估计方法。

除了上述介绍的波动率估计方法，还有一些其他常见的波动率估计方法，例如：

Garman-Klass-Yang-Zhang (GKY) 波动率：是 Garman-Klass 波动率和 Yang-Zhang 波动率的加权平均值，适用于高频数据和收益率具有异方差性的情况。

Hansen-Hodrick (HH) 波动率：是一种基于频谱分析的波动率估计方法，可以有效地处理非等间隔数据和季节性变动的数据。

Generalized Autoregressive Conditional Heteroskedasticity (GARCH) 波动率：是一种常见的波动率建模方法，可以捕捉收益率序列的异方差性和自相关性，常用于金融时间序列的预测和风险管理。

以上仅是常见的几种波动率估计方法，实际上还有许多其他方法和技术可以用于波动率估计和波动率建模，需要根据具体情况进行选择和应用。

```



```
df['Price'].pct_change()

在金融领域，收益率通常被认为是近似正态分布的，尤其是在大量数据和大样本量的情况下。这是基于中心极限定理的观点，该定理表明当多个独立随机变量相加时，它们的总和将趋向于正态分布。

然而，需要注意的是，金融市场中的收益率并不完全符合理想的正态分布。实际上，金融市场中的收益率通常具有一些非正态性质，如尖峰度（kurtosis）和偏度（skewness）。

尖峰度是描述分布形状尖锐程度的统计量，正态分布的尖峰度为3。金融市场中的收益率分布通常呈现出较高的尖峰度，即尾部的厚重性，表明了极端事件的发生频率高于正态分布预期。

偏度是描述分布对称性的统计量，正态分布的偏度为0。金融市场中的收益率分布通常呈现出较大的偏度，即分布的偏斜性，表明了正向或负向收益的非对称分布特征。

因此，虽然在一些假设和近似条件下，金融市场中的收益率可以被视为近似正态分布，但实际情况中通常存在一些偏离正态分布的特征。这就需要在金融建模和风险管理中考虑更加灵活和复杂的分布形式，如偏态分布和厚尾分布，以更好地捕捉金融市场的特点。


根据金融市场中收益率的非正态性特点，可以衍生出一些套利策略或交易机会。以下是一些常见的套利方式：

偏度套利（Skewness Arbitrage）：利用市场中收益率分布的偏斜性来进行套利。当市场中的偏斜性不符合理论预期时，可以尝试建立多头或空头头寸以从偏斜中获利。

尾部风险套利（Tail Risk Arbitrage）：利用市场中收益率分布尾部的厚重性来进行套利。通过购买或卖出具有极端收益潜力的金融工具，以捕捉市场中极端事件的发生，并从中获利。

期权套利（Options Arbitrage）：利用期权市场中的定价差异或错配来进行套利。通过购买和销售不同期权合约组合，可以利用市场中的价格不一致或套利机会。

波动率套利（Volatility Arbitrage）：利用市场中波动率的不一致性来进行套利。通过建立对冲头寸，可以从市场中的波动率变动中获利，例如建立配对交易或期权对冲策略。

时间价值套利（Time Value Arbitrage）：利用期权市场中的时间价值差异进行套利。当期权的到期日和执行价格存在不一致时，可以尝试建立对冲头寸以从时间价值差异中获利。


```